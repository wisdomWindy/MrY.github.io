"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[389],{7389:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var r=a(311);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){if("object"!==i(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function o(e){var t=n(e,"string");return"symbol"===i(t)?t:String(t)}function s(e,t,a){return t=o(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(e,t,a){l(e,t),t.set(e,a)}function h(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}function u(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}function f(e,t,a){var r=u(e,t,"set");return h(e,r,a),a}function d(e,t){return t.get?t.get.call(e):t.value}function p(e,t){var a=u(e,t,"get");return d(e,a)}var E;(function(e){e["LOAD"]="LOAD",e["EXEC"]="EXEC",e["WRITE_FILE"]="WRITE_FILE",e["READ_FILE"]="READ_FILE",e["DELETE_FILE"]="DELETE_FILE",e["RENAME"]="RENAME",e["CREATE_DIR"]="CREATE_DIR",e["LIST_DIR"]="LIST_DIR",e["DELETE_DIR"]="DELETE_DIR",e["ERROR"]="ERROR",e["DOWNLOAD"]="DOWNLOAD",e["PROGRESS"]="PROGRESS",e["LOG"]="LOG"})(E||(E={}));const w=(()=>{let e=0;return()=>e++})(),y=(new Error("unknown message type"),new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first")),m=new Error("called FFmpeg.terminate()");new Error("failed to import ffmpeg-core.js");var b=new WeakMap,R=new WeakMap,v=new WeakMap,L=new WeakMap,g=new WeakMap,D=new WeakMap,I=new WeakMap;class A{constructor(){c(this,b,{writable:!0,value:null}),c(this,R,{writable:!0,value:{}}),c(this,v,{writable:!0,value:{}}),c(this,L,{writable:!0,value:[]}),c(this,g,{writable:!0,value:[]}),s(this,"loaded",!1),c(this,D,{writable:!0,value:()=>{p(this,b)&&(p(this,b).onmessage=({data:{id:e,type:t,data:a}})=>{switch(t){case E.LOAD:this.loaded=!0,p(this,R)[e](a);break;case E.EXEC:case E.WRITE_FILE:case E.READ_FILE:case E.DELETE_FILE:case E.RENAME:case E.CREATE_DIR:case E.LIST_DIR:case E.DELETE_DIR:p(this,R)[e](a);break;case E.LOG:p(this,L).forEach((e=>e(a)));break;case E.PROGRESS:p(this,g).forEach((e=>e(a)));break;case E.ERROR:p(this,v)[e](a);break}delete p(this,R)[e],delete p(this,v)[e]})}}),c(this,I,{writable:!0,value:({type:e,data:t},a=[])=>p(this,b)?new Promise(((r,i)=>{const n=w();p(this,b)&&p(this,b).postMessage({id:n,type:e,data:t},a),p(this,R)[n]=r,p(this,v)[n]=i})):Promise.reject(y)}),s(this,"load",((e={})=>(p(this,b)||(f(this,b,new Worker(new URL(a.p+a.u(401),a.b),{type:void 0})),p(this,D).call(this)),p(this,I).call(this,{type:E.LOAD,data:e})))),s(this,"exec",((e,t=-1)=>p(this,I).call(this,{type:E.EXEC,data:{args:e,timeout:t}}))),s(this,"terminate",(()=>{const e=Object.keys(p(this,v));for(const t of e)p(this,v)[t](m),delete p(this,v)[t],delete p(this,R)[t];p(this,b)&&(p(this,b).terminate(),f(this,b,null),this.loaded=!1)})),s(this,"writeFile",((e,t)=>{const a=[];return t instanceof Uint8Array&&a.push(t.buffer),p(this,I).call(this,{type:E.WRITE_FILE,data:{path:e,data:t}},a)})),s(this,"readFile",((e,t="binary")=>p(this,I).call(this,{type:E.READ_FILE,data:{path:e,encoding:t}}))),s(this,"deleteFile",(e=>p(this,I).call(this,{type:E.DELETE_FILE,data:{path:e}}))),s(this,"rename",((e,t)=>p(this,I).call(this,{type:E.RENAME,data:{oldPath:e,newPath:t}}))),s(this,"createDir",(e=>p(this,I).call(this,{type:E.CREATE_DIR,data:{path:e}}))),s(this,"listDir",(e=>p(this,I).call(this,{type:E.LIST_DIR,data:{path:e}}))),s(this,"deleteDir",(e=>p(this,I).call(this,{type:E.DELETE_DIR,data:{path:e}})))}on(e,t){"log"===e?p(this,L).push(t):"progress"===e&&p(this,g).push(t)}off(e,t){"log"===e?f(this,L,p(this,L).filter((e=>e!==t))):"progress"===e&&f(this,g,p(this,g).filter((e=>e!==t)))}}const _=new Error("failed to get response body reader"),T=new Error("failed to complete download"),k="Content-Length",F=e=>new Promise(((t,a)=>{const r=new FileReader;r.onload=()=>{const{result:e}=r;e instanceof ArrayBuffer?t(new Uint8Array(e)):t(new Uint8Array)},r.onerror=e=>{a(Error(`File could not be read! Code=${e?.target?.error?.code||-1}`))},r.readAsArrayBuffer(e)})),O=async e=>{let t;if("string"===typeof e)t=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?atob(e.split(",")[1]).split("").map((e=>e.charCodeAt(0))):await(await fetch(e)).arrayBuffer();else if(e instanceof URL)t=await(await fetch(e)).arrayBuffer();else{if(!(e instanceof File||e instanceof Blob))return new Uint8Array;t=await F(e)}return new Uint8Array(t)},C=async(e,t)=>{const a=await fetch(e);let r;try{const i=parseInt(a.headers.get(k)||"-1"),n=a.body?.getReader();if(!n)throw _;const o=[];let s=0;for(;;){const{done:a,value:r}=await n.read(),l=r?r.length:0;if(a){if(-1!=i&&i!==s)throw T;t&&t({url:e,total:i,received:s,delta:l,done:a});break}o.push(r),s+=l,t&&t({url:e,total:i,received:s,delta:l,done:a})}const l=new Uint8Array(s);let c=0;for(const e of o)l.set(e,c),c+=e.length;r=l.buffer}catch(i){r=await a.arrayBuffer(),t&&t({url:e,total:r.byteLength,received:r.byteLength,delta:0,done:!0})}return r},S=async(e,t,a=!1,r)=>{const i=a?await C(e,r):await(await fetch(e)).arrayBuffer(),n=new Blob([i],{type:t});return URL.createObjectURL(n)};var U=a(1103);const W={class:"video-transform"},M=(0,r.createTextVNode)("select file");var j={setup(e){const t=(0,r.ref)(null),a=new A,i="https://unpkg.com/@ffmpeg/core@0.12.2/dist/umd";async function n(e){try{await a.load({coreURL:await S(`${i}/ffmpeg-core.js`,"text/javascript"),wasmURL:await S(`${i}/ffmpeg-core.wasm`,"application/wasm")});let r=await O(e.raw);await a.writeFile("input.wmv",r),await a.exec(["-i","input.wmv","-f","mp4","output.mp4"]);const n=await a.readFile("output.mp4");t.value.src=URL.createObjectURL(new Blob([n.buffer],{type:"video/mp4"}))}catch(r){U.z8.error({message:r.message})}}return(e,a)=>{const i=(0,r.resolveComponent)("el-button"),o=(0,r.resolveComponent)("el-upload");return(0,r.openBlock)(),(0,r.createElementBlock)("div",W,[(0,r.createVNode)(o,{ref:(e,t)=>{t["uploadRef"]=e},class:"upload-demo",accept:"video/*","auto-upload":!1,"on-change":n},{trigger:(0,r.withCtx)((()=>[(0,r.createVNode)(i,{type:"primary"},{default:(0,r.withCtx)((()=>[M])),_:1})])),_:1},512),(0,r.createElementVNode)("video",{class:"video",ref:(e,a)=>{a["video"]=e,t.value=e}},null,512)])}}},B=a(9110);const N=(0,B.Z)(j,[["__scopeId","data-v-60d1a494"]]);var P=N}}]);